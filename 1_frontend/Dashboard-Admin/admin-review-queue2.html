<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Admin Review Queue 2 - UniVault</title>
    <link rel="stylesheet" href="admin-review-queue2.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manjari:wght@100;400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="review-queue-page">
    <div class="page-container">
      <div class="page-wrapper">
        <!-- Sidebar Navigation -->
        <nav class="left-side-bar" role="navigation" aria-label="Admin navigation">
          <div class="customer-options">
            <div class="customer-options-container">
              <a id="dashboard-option" href="admin-dashboard.html">Dashboard</a>
            </div>
            <div class="customer-options-container">
              <a id="user-management-option" href="admin-user-management.html">User Management</a>
            </div>
            <div class="customer-options-container active">
              <a id="review-queue-option" href="admin-review-queue.html">Review Queue</a>
            </div>
            <div class="customer-options-container">
              <a id="closed-account-option" href="admin-closed-account.html">Closed Accounts</a>
            </div>
          </div>
        </nav>

        <!-- Main Content Area -->
        <main class="wrapper">
          <!-- Top Navigation Bar -->
          <nav class="nav-bar" role="navigation" aria-label="Page navigation">
            <div class="nav-content">
              <h3 class="page-title">Review Queue</h3>
              <div class="logout-container" id="logout-btn" tabindex="0" role="button" aria-label="Logout">
                <span class="logout-text">Logout</span>
                <img id="log-out" src="../assets/log-out-logo.png" alt="Log Out" />
              </div>
            </div>
          </nav>

          <!-- Page Header -->
          <header class="header">
            <div class="welcome-message">
              <h1 class="welcome">
                <span class="blue-text">Request Approvals</span>
              </h1>
              <p class="blue-text">
                Review and approve customer service requests and transactions.
              </p>
            </div>
          </header>

          <!-- Progress Steps -->
          <div class="progress-container">
            <div class="progress-line"></div>
            <div class="progress-step">
              <div
                onclick="window.location.href='admin-review-queue.html'"
                class="circle"
                role="button"
                tabindex="0"
                aria-label="Verify Accounts"
              ></div>
              <div
                onclick="window.location.href='admin-review-queue.html'"
                class="label"
                role="button"
                tabindex="0"
              >
                Verify Accounts
              </div>
            </div>
            <div class="progress-step active">
              <div
                onclick="window.location.href='admin-review-queue2.html'"
                class="circle"
                role="button"
                tabindex="0"
                aria-label="Approve Requests"
              ></div>
              <div
                onclick="window.location.href='admin-review-queue2.html'"
                class="label"
                role="button"
                tabindex="0"
              >
                Approve Requests
              </div>
            </div>
          </div>

          <!-- Page Body -->
          <div class="page-body">
            <!-- Search Container -->
            <div class="search-container">
              <div class="search-bar-wrapper">
                <input
                  type="text"
                  id="queueSearchBar"
                  placeholder="Search by name, CIF number, email, or request type..."
                  class="search-input"
                  aria-label="Search requests"
                />
                <div class="search-icon" aria-hidden="true">üîç</div>
                <div class="search-loading-spinner" aria-hidden="true"></div>
              </div>
              <div id="searchResults" class="search-results" style="display: none;" role="listbox" aria-label="Search results"></div>
            </div>

            <!-- Filter Controls -->
            <div class="filter-controls">
              <div class="filter-group">
                <label for="statusFilter">Filter by Status:</label>
                <select id="statusFilter" class="filter-select">
                  <option value="">All Statuses</option>
                  <option value="PENDING">Pending</option>
                  <option value="UNDER_REVIEW">Under Review</option>
                  <option value="APPROVED">Approved</option>
                  <option value="REJECTED">Rejected</option>
                  <option value="COMPLETED">Completed</option>
                </select>
              </div>
              <div class="filter-group">
                <label for="requestTypeFilter">Request Type:</label>
                <select id="requestTypeFilter" class="filter-select">
                  <option value="">All Types</option>
                  <option value="ACCOUNT_DEACTIVATION">Account Deactivation</option>
                  <option value="PROFILE_UPDATE">Profile Update</option>
                  <option value="TRANSACTION_REVIEW">Transaction Review</option>
                  <option value="DOCUMENT_UPDATE">Document Update</option>
                </select>
              </div>
              <div class="filter-group">
                <label for="assigneeFilter">Assigned To:</label>
                <select id="assigneeFilter" class="filter-select">
                  <option value="">All Assignees</option>
                  <option value="ME">My Reviews</option>
                  <option value="UNASSIGNED">Unassigned</option>
                </select>
              </div>
              <button id="refreshBtn" class="refresh-btn" aria-label="Refresh queue">
                üîÑ Refresh
              </button>
            </div>

            <!-- Batch Actions -->
            <div class="batch-actions" id="batchActions" style="display: none;">
              <div class="batch-info">
                <span id="selectedCount">0</span> items selected
              </div>
              <div class="batch-buttons">
                <button id="batchApproveBtn" class="batch-btn approve">Approve Selected</button>
                <button id="batchRejectBtn" class="batch-btn reject">Reject Selected</button>
                <button id="batchAssignBtn" class="batch-btn assign">Assign to Me</button>
                <button id="clearSelectionBtn" class="batch-btn clear">Clear Selection</button>
              </div>
            </div>

            <!-- Review Queue Table -->
            <div class="account-info">
              <div class="loading-container" id="loadingContainer" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Loading review queue...</p>
              </div>
              
              <div class="error-container" id="errorContainer" style="display: none;">
                <div class="error-message">
                  <h3>Error Loading Data</h3>
                  <p id="errorMessage">Unable to load review queue. Please try again.</p>
                  <button id="retryBtn" class="retry-btn">Retry</button>
                </div>
              </div>

              <div class="transaction-info" id="reviewQueueTable">
                <div class="top-label">
                  <div class="table-header">
                    <h2>Request Approval Queue</h2>
                    <div class="queue-stats">
                      <span class="stat-item">
                        <span class="stat-label">Total:</span>
                        <span id="totalCount" class="stat-value">0</span>
                      </span>
                      <span class="stat-item">
                        <span class="stat-label">Pending:</span>
                        <span id="pendingCount" class="stat-value">0</span>
                      </span>
                      <span class="stat-item">
                        <span class="stat-label">My Reviews:</span>
                        <span id="myReviewsCount" class="stat-value">0</span>
                      </span>
                    </div>
                  </div>
                  <div class="top-label-2" role="row">
                    <label role="columnheader">
                      <input type="checkbox" id="selectAll" aria-label="Select all items" />
                    </label>
                    <label role="columnheader">CIF Number</label>
                    <label role="columnheader">Request Date</label>
                    <label role="columnheader">Request Type</label>
                    <label role="columnheader">Customer Name</label>
                    <label role="columnheader">Email Address</label>
                    <label role="columnheader">Phone Number</label>
                    <label role="columnheader">Assigned To</label>
                    <label role="columnheader">Priority</label>
                    <label role="columnheader">Status</label>
                  </div>
                </div>

                <div id="reviewQueueItems" class="queue-items">
                  <!-- Customer cards will be dynamically populated -->
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="empty-state" style="display: none;">
                  <div class="empty-icon">üìã</div>
                  <h3>No Pending Requests</h3>
                  <p>There are currently no requests pending approval.</p>
                </div>
              </div>
            </div>

            <!-- Pagination -->
            <div class="pagination-container" id="paginationContainer" style="display: none;">
              <div class="pagination-info">
                <span id="pageInfo">Showing 1-10 of 0 items</span>
              </div>
              <div class="pagination-controls">
                <button id="prevPageBtn" class="page-btn" disabled>Previous</button>
                <div id="pageNumbers" class="page-numbers"></div>
                <button id="nextPageBtn" class="page-btn" disabled>Next</button>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Review Details Modal -->
    <div id="reviewModal" class="modal" style="display: none;" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Request Review</h2>
          <button class="modal-close" id="closeModal" aria-label="Close modal">&times;</button>
        </div>
        <div class="modal-body" id="modalBody">
          <!-- Modal content will be populated dynamically -->
        </div>
        <div class="modal-footer">
          <button id="assignToMeBtn" class="action-btn assign-btn">Assign to Me</button>
          <button id="approveBtn" class="action-btn approve-btn">Approve</button>
          <button id="rejectBtn" class="action-btn reject-btn">Reject</button>
          <button id="cancelBtn" class="action-btn cancel-btn">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Comments Modal -->
    <div id="commentsModal" class="modal" style="display: none;" role="dialog" aria-labelledby="commentsModalTitle" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="commentsModalTitle">Add Review Comments</h2>
          <button class="modal-close" id="closeCommentsModal" aria-label="Close modal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="reviewComments">Comments (Optional):</label>
            <textarea
              id="reviewComments"
              class="form-textarea"
              rows="4"
              placeholder="Add any additional comments about this review..."
            ></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button id="submitReviewBtn" class="action-btn submit-btn">Submit Review</button>
          <button id="cancelCommentsBtn" class="action-btn cancel-btn">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
      <div class="loading-content">
        <div class="loading-spinner large"></div>
        <p>Processing request...</p>
      </div>
    </div>

    <!-- Scripts -->
    <script src="utils/logout-fix.js"></script>
    <script src="utils/search-functionality.js"></script>
    <script src="admin-review-queue2.js"></script>
  </body>
</html>
